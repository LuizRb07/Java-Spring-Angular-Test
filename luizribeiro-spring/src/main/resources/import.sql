CREATE VIEW vwCandidato AS SELECT *, TIMESTAMPDIFF(year, nascimento, now()) as idade, round(peso/(altura*altura), 2) as imc FROM tb_candidato;
CREATE VIEW vwCandidato_group_faixaEtaria AS SELECT case when idade between 0 and 10 then 'de 00 a 10 anos' when idade between 11 and 20 then 'de 11 a 20 anos' when idade between 21 and 30 then 'de 21 a 30 anos' when idade between 31 and 40 then 'de 31 a 40 anos' when idade between 41 and 50 then 'de 41 a 50 anos' when idade between 51 and 60 then 'de 51 a 60 anos' when idade between 61 and 70 then 'de 61 a 70 anos' when idade between 71 and 80 then 'de 71 a 80 anos' when idade between 81 and 90 then 'de 81 a 90 anos' when idade between 91 and 100 then 'de 91 a 100 anos' else 'mais de 100 anos' end as faixaEtaria, count(*) as candidatos, round(avg(imc),2) as imcmedio FROM vwcandidato GROUP BY faixaetaria ORDER BY faixaEtaria;
CREATE VIEW vwCandidato_group_estado AS SELECT estado, count(*) as candidatos FROM tb_candidato GROUP BY estado ORDER BY candidatos DESC;
CREATE VIEW vwCandidato_group_sangue AS SELECT sangue, count(*) as candidatos, round(avg(idade)) as idademedia  FROM vwcandidato GROUP BY sangue ORDER BY candidatos DESC;
CREATE VIEW vwCandidato_group_genero AS SELECT sexo, @t := count(*) as candidatos, @o := sum(imc>30) as obesidade, @o*100/@t as obesidadeperc FROM vwcandidato GROUP BY sexo ORDER BY candidatos DESC;
